<body>
    <script type="text/javascript">

        // Open a connection
        let source = new EventSource('sse?username=hogemoge');

        // When a connection is made
        source.onopen = function () {
            console.log('Opened connection ');
        };

        // A connection could not be made
        source.onerror = function (event) {
            console.log(event);
        };

        // When data is received
        source.onmessage = function (event) {
            console.log(event.data);
        };

        // A connection was closed
        source.onclose = function (code, reason) {
            console.log(code, reason);
        }

        // Close the connection when the window is closed
        window.addEventListener('beforeunload', function () {
            source.close();
        });

        // custom event
        source.addEventListener("hogemoge", function (event) {
            console.log('onmessage: ' + event.data);
        });

    </script>
</body>